<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ…§æ¤ç‰©ç›£æ¸¬å„€è¡¨æ¿</title>
    <style>
        :root { --bg: #0f172a; --card: rgba(255,255,255,0.05); --green: #22c55e; }
        body { margin: 0; font-family: sans-serif; background: var(--bg); color: white; display: flex; height: 100vh; }
        
        /* å´é‚Šæ¬„ */
        .sidebar { width: 200px; background: rgba(0,0,0,0.3); padding: 20px; display: flex; flex-direction: column; gap: 15px; border-right: 1px solid rgba(255,255,255,0.1); }
        .nav-item { padding: 12px; border-radius: 8px; cursor: pointer; color: #94a3b8; transition: 0.3s; }
        .nav-item.active { background: var(--green); color: white; }

        /* ä¸»ç•«é¢ */
        .main-content { flex: 1; padding: 40px; display: flex; flex-direction: column; gap: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        
        /* å››å®®æ ¼ */
        .plant-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; flex: 1; }
        .stat-card { background: var(--card); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; }
        .label { color: #94a3b8; font-size: 1.2rem; margin-bottom: 10px; }
        .value { font-size: 2.5rem; font-weight: bold; color: var(--green); }
        
        #data-status { font-size: 14px; color: #94a3b8; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="nav-item active">ğŸŒ¿ æ¤ç‰©ç›£æ¸¬</div>
        <div class="nav-item">ğŸ“Š æ­·å²æ•¸æ“š</div>
        <div class="nav-item">âš™ï¸ è¨­å®š</div>
    </div>

    <div class="main-content">
        <div class="header">
            <h2>æ™ºæ…§æ¤ç‰©ç›£æ¸¬å„€è¡¨æ¿</h2>
            <div id="data-status">â— åŒæ­¥ä¸­...</div>
        </div>

        <div class="plant-grid">
            <div class="stat-card">
                <div class="label">æº«åº¦</div>
                <div class="value" id="plant-temp">-- Â°C</div>
            </div>
            <div class="stat-card">
                <div class="label">æ¿•åº¦</div>
                <div class="value" id="plant-humi">-- %</div>
            </div>
            <div class="stat-card">
                <div class="label">åœŸå£¤æ¿•åº¦</div>
                <div class="value" id="plant-soil">-- %</div>
            </div>
            <div class="stat-card">
                <div class="label">CO2</div>
                <div class="value" id="plant-co2">-- ppm</div>
            </div>
        </div>
    </div>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbzAaqP79kMX9Uq_QtIqnwMx8tp2v62k6H5lDOCtCZV2W73NwfWN9kFdMz0Myalx2vxRFw/exec";

        async function updateData() {
            try {
                const res = await fetch(GAS_URL);
                const data = await res.json();
                
                if (data && data.length > 0) {
                    const last = data[data.length - 1];
                    console.log("æœ€æ–°æ•¸æ“š:", last);

                    // 1. æº«åº¦
                    document.getElementById('plant-temp').textContent = (last["æº«åº¦"] || "0") + " Â°C";
                    // 2. æ¿•åº¦
                    document.getElementById('plant-humi').textContent = (last["æ¿•åº¦"] || "0") + " %";
                    // 3. åœŸå£¤æ¿•åº¦
                    document.getElementById('plant-soil').textContent = (last["åœŸå£¤æ¿•åº¦"] || "0") + " %";
                    
                    // 4. CO2 (ä¿®æ­£ï¼šå°æ‡‰è©¦ç®—è¡¨çš„å°å¯« co2)
                    // ä½¿ç”¨ last["co2"] ç¢ºä¿èƒ½æŠ“åˆ° 793 é€™å€‹æ•¸å€¼
                    const co2Value = last["co2"] || last["CO2"] || "0";
                    document.getElementById('plant-co2').textContent = co2Value + " ppm";

                    document.getElementById('data-status').textContent = `â— å·²æ›´æ–°: ${last["æ™‚é–“"] || ""}`;
                    document.getElementById('data-status').style.color = "#22c55e";
                }
            } catch (err) {
                console.error("æŠ“å–å¤±æ•—:", err);
                document.getElementById('data-status').textContent = "â— é€£ç·šå¤±æ•—";
                document.getElementById('data-status').style.color = "#ef4444";
            }
        }

        // ç«‹å³åŸ·è¡Œä¸¦è¨­å®šæ’ç¨‹
        updateData();
        setInterval(updateData, 30000);
    </script>
</body>
</html>
