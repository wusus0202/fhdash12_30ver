<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ…§æ¤ç‰©ç›£æ¸¬å„€è¡¨æ¿</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --sidebar-bg: #1e293b;
            --accent-green: #22c55e;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* å´é‚Šå°è¦½åˆ— */
        .sidebar {
            width: 240px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            padding: 20px 0;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-brand {
            padding: 0 25px 30px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-item {
            padding: 15px 25px;
            cursor: pointer;
            color: var(--text-dim);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
        }

        .nav-item.active {
            background: rgba(34, 197, 94, 0.15);
            color: var(--accent-green);
            border-right: 4px solid var(--accent-green);
        }

        /* ä¸»å…§å®¹å€å¡Š */
        .content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .header h2 {
            margin: 0;
            font-size: 1.8rem;
        }

        #data-status {
            font-size: 0.85rem;
            padding: 8px 16px;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s;
        }

        /* æ¤ç‰©ç›£æ¸¬å››å®®æ ¼ä½ˆå±€ */
        .plant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            flex: 1;
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(12px);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            border-color: rgba(34, 197, 94, 0.4);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .label {
            color: var(--text-dim);
            font-size: 1.1rem;
            margin-bottom: 15px;
            letter-spacing: 1px;
        }

        .value-container {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .value {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--text-main);
        }

        .unit {
            font-size: 1.2rem;
            color: var(--accent-green);
            font-weight: 500;
        }

        /* åˆ†é é¡¯ç¤ºé‚è¼¯ */
        .page-content {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .page-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; border-right: none; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
            .plant-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="sidebar-brand">ğŸŒ¿ æ™ºæ…§æ¤æ ½</div>
        <div class="nav-item active" onclick="showPage('plant-page', this)">ç’°å¢ƒç›£æ¸¬</div>
        <div class="nav-item" onclick="showPage('history-page', this)">æ•¸æ“šåœ–è¡¨</div>
        <div class="nav-item" onclick="showPage('settings-page', this)">ç³»çµ±è¨­å®š</div>
    </nav>

    <div class="content">
        <div class="header">
            <h2 id="page-title">ç’°å¢ƒç›£æ¸¬</h2>
            <div id="data-status">â— æ­£åœ¨é€£ç·šåŒæ­¥ä¸­...</div>
        </div>

        <div id="plant-page" class="page-content active">
            <div class="plant-grid">
                <div class="stat-card">
                    <div class="label">ç©ºæ°£æº«åº¦</div>
                    <div class="value-container">
                        <span class="value" id="plant-temp">--</span>
                        <span class="unit">Â°C</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="label">ç©ºæ°£æ¿•åº¦</div>
                    <div class="value-container">
                        <span class="value" id="plant-humi">--</span>
                        <span class="unit">%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="label">åœŸå£¤æ¿•åº¦</div>
                    <div class="value-container">
                        <span class="value" id="plant-soil">--</span>
                        <span class="unit">%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="label">äºŒæ°§åŒ–ç¢³ (CO2)</div>
                    <div class="value-container">
                        <span class="value" id="plant-co2">--</span>
                        <span class="unit">ppm</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="history-page" class="page-content">
            <p style="color: var(--text-dim);">æ•¸æ“šåœ–è¡¨åŠŸèƒ½é–‹ç™¼ä¸­ï¼Œç›®å‰åƒ…ä¾›å³æ™‚ç›£æ¸¬...</p>
        </div>

        <div id="settings-page" class="page-content">
            <p style="color: var(--text-dim);">ç³»çµ±è¨­å®šè¼‰å…¥ä¸­...</p>
        </div>
    </div>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbzAaqP79kMX9Uq_QtIqnwMx8tp2v62k6H5lDOCtCZV2W73NwfWN9kFdMz0Myalx2vxRFw/exec";

        // åˆ†é åˆ‡æ›åŠŸèƒ½
        function showPage(pageId, element) {
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            element.classList.add('active');
            document.getElementById('page-title').innerText = element.innerText;
        }

        // æ ¸å¿ƒæ•¸æ“šè®€å–åŠŸèƒ½
        async function fetchPlantData() {
            try {
                const response = await fetch(GAS_URL);
                if (!response.ok) throw new Error('ç¶²è·¯å›æ‡‰ä¸æ­£å¸¸');
                
                const data = await response.json();

                if (data && data.length > 0) {
                    // æŠ“å–æœ€å¾Œä¸€ç­† (æœ€æ–°) è³‡æ–™
                    const lastEntry = data[data.length - 1];
                    console.log("æœ€æ–°æ¥æ”¶æ•¸æ“š:", lastEntry);

                    // 1. æ›´æ–°æº«åº¦
                    document.getElementById('plant-temp').textContent = lastEntry["æº«åº¦"] || "0";
                    // 2. æ›´æ–°æ¿•åº¦
                    document.getElementById('plant-humi').textContent = lastEntry["æ¿•åº¦"] || "0";
                    // 3. æ›´æ–°åœŸå£¤æ¿•åº¦
                    document.getElementById('plant-soil').textContent = lastEntry["åœŸå£¤æ¿•åº¦"] || "0";
                    
                    // 4. æ›´æ–° CO2 (é—œéµä¿®æ­£ï¼šå°æ‡‰è©¦ç®—è¡¨ä¸­çš„å°å¯« "co2" æ¬„ä½)
                    // é€™é‚Šä½¿ç”¨ || é‚è¼¯ï¼Œå¦‚æœ "co2" æŠ“ä¸åˆ°æœƒæŠ“ "CO2"ï¼Œéƒ½æŠ“ä¸åˆ°æ‰é¡¯ç¤º 0
                    const co2Value = lastEntry["co2"] || lastEntry["CO2"] || "0";
                    document.getElementById('plant-co2').textContent = co2Value;

                    // æ›´æ–°åŒæ­¥ç‹€æ…‹èˆ‡æ™‚é–“
                    const statusEl = document.getElementById('data-status');
                    statusEl.textContent = `â— æœ€å¾ŒåŒæ­¥æ™‚é–“: ${lastEntry["æ™‚é–“"] || "å‰›æ‰"}`;
                    statusEl.style.color = "#22c55e";
                    statusEl.style.borderColor = "rgba(34, 197, 94, 0.3)";
                }
            } catch (error) {
                console.error("æŠ“å–å¤±æ•—:", error);
                const statusEl = document.getElementById('data-status');
                statusEl.textContent = "â— é€£ç·šç•°å¸¸ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– GAS è¨­å®š";
                statusEl.style.color = "#ef4444";
            }
        }

        // åˆå§‹åŒ–èˆ‡æ’ç¨‹æ›´æ–° (æ¯ 30 ç§’æ›´æ–°ä¸€æ¬¡)
        fetchPlantData();
        setInterval(fetchPlantData, 30000);
    </script>
</body>
</html>
